{% extends "layout.html" %}

{% block content %}
<!-- Carousel (unchanged) -->
<div class="container-fluid p-0">
    <div id="carouselExampleAutoplaying" class="carousel slide" data-bs-ride="carousel" data-bs-interval="4000">
        <div class="carousel-inner">
            <div class="carousel-item active">
                <img src="{{ url_for('static', filename='images/carusel1.jpeg') }}" class="d-block w-100" alt="carousel image">
                <div class="carousel-caption">
                    <p class="first-card">Socotra doesnâ€™t pretend to be wildâ€”it just is</p>
                    <a href="/tour" class="carousel-book-btn mt-3">Book Now</a>
                </div>
            </div>
            <div class="carousel-item">
                <img src="{{ url_for('static', filename='images/carusel2.jpeg') }}" class="d-block w-100" alt="carousel image">
                <div class="carousel-caption">
                    <p class="second-card">This island doesnâ€™t care who you are </p>
                        <p class="second-card2">But it might change who you become</p>
                    <a href="/tour" class="carousel-book-btn mt-3">Book Now</a>
                </div>
            </div>
            <div class="carousel-item">
                <img src="{{ url_for('static', filename='images/carusel3.jpeg') }}" class="d-block w-100" alt="carousel image">
                <div class="carousel-caption">
                    <p class="third-card">Travel with a team that respects the island </p>
                        <p class="third-card2">and the people who call it home</p>
                    <a href="/tour" class="carousel-book-btn mt-3">Book Now</a>
                </div>
            </div>
            <div class="carousel-item">
                <img src="{{ url_for('static', filename='images/carusel6.jpeg') }}" class="d-block w-100" alt="carousel image">
                <div class="carousel-caption">
                    <p class="forth-card">Book your tour now and join us </p>
                    <p class="forth-card2">for the adventure of a lifetime</p>
                    <a href="/tour" class="carousel-book-btn mt-3">Book Now</a>
                </div>
            </div>
        </div>
        <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleAutoplaying" data-bs-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Previous</span>
        </button>
        <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleAutoplaying" data-bs-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Next</span>
        </button>
    </div>
</div>

<!-- Redesigned Tour Section -->
<section class="tours-section">
    <h2 class="section-title">Choose Your Adventure</h2>
    <div class="tour-card-grid">
        <div class="tour-square-card">
            <h5>Full Island Tour</h5>
            <p>For those wanting to explore everything Socotra has to offer.</p>
            <br>
            <a href="{{ url_for('full_island_tour') }}" class="tour-card-btn"">Learn More</a>
        </div>
        <div class="tour-square-card">
            <h5>Trekking Tour</h5>
            <p>For the mountain lovers and adrenaline seekers.</p>
            <br>
            <br>
           <a href="{{ url_for('trekking_tour') }}" class="tour-card-btn"">Learn More</a>

        </div>

        <div class="tour-square-card">
            <h5>Beach Lover</h5>
            <p>For those seeking the calm and tranquility of pristine beaches and magical lagoons.</p>
            <br>
        
         <a href="{{ url_for('beach_lover') }}" class="tour-card-btn"">Learn More</a>

        </div>
        <div class="tour-square-card">
            <h5>The VIP</h5>
            <p>For luxury adventurers with a plan.</p>
            <br>
            <br>
            <a href="/tour/vip" class="tour-card-btn">Learn More</a>
        </div>
    </div>
</section>


<!-- Experience Highlights Section -->
<section class="experience-highlights">
    <h2 class="section-title">Experience Socotra</h2>
    <div class="highlight-card-grid">
        <div class="highlight-card">
            <img src="{{ url_for('static', filename='images/isolation-home.jpeg') }}" alt="Island Life">
            <div class="highlight-content">
                <h5>UNMATCHED ISOLATION</h5>
                <p class="caption">Socotra: Where Earth Still Breathes</p>
                <div class="hover-reveal">
                   Step off the map and into a world unlike anywhere else. 
                    Socotra Island travel is not about luxury in things â€” it's about the luxury of silence, space, and solitude.
                    No crowds. No chaos. Just you, the wind, and a world untouched by time
                    <br>
                    <br>
                </div>
            </div>
        </div>

        <div class="highlight-card">
            <img src="{{ url_for('static', filename='images/nature-home.jpeg') }}" alt="Wild Nature">
            <div class="highlight-content">
                <h5>NATURE UNTOUCHED</h5>
                <p class="caption">Discover Earthâ€™s Last Natural Secret</p>
                <div class="hover-reveal">
                 Swim in hidden wadis, climb untouched cliffs, and hike into Dragon Blod Tree forests â€” all in one island.
                 Socotraâ€™s untouched nature is more than a destination, itâ€™s a revelation where every corner feels like a first discovery.
                 <br>
                 <br>
                </div>
            </div>
        </div>

        <div class="highlight-card">
            <img src="{{ url_for('static', filename='images/culture-home.jpeg') }}" alt="Culture">
            <div class="highlight-content">
                <h5>IMMERSIVE CULTURE</h5>
                <p class="caption">Live the Island, Not Just Visit It</p>
                <div class="hover-reveal">
                    Meet the resilient people of Socotra â€” fishermen, nomads, storytellers.
                    Learn traditional ways of living, share meals under starlit skies, and feel what it means to truly belong, even as a guest.
                    Here, culture isn't curated â€” itâ€™s lived. Socotra is a journey into deep authenticity
                </div>
            </div>
        </div>
    </div>
</section>


<!-- Upcoming Departures Section (Updated for Grouped Departures with Single Action Button) -->
<section class="exp-table-section" id="exp-table">
    <div class="exp-table-header">
        <h2 class="exp-table-title">Upcoming Group Tour Departures</h2>
        <p class="exp-table-subtitle">
            2025 / 2026 Season â€“ 8 Days / 7 Nights Option  
            <br>
            <strong>Limited spaces available:</strong> Book early to secure your spot!
        </p>
    </div>

    <div class="exp-table-wrapper">
        <table class="exp-table">
            <thead>
                <tr>
                    <th>Tours</th>
                    <th>Date</th>     
                    <th>Action</th>
                </tr>
            </thead>
            <tbody>
                {% for date, departures_on_date in grouped_departures %}
                <tr>
                    <!-- Tours -->
                    <td>
                        {% for dep in departures_on_date %}
                            {{ dep.tour.title }}{% if not loop.last %}, {% endif %}
                        {% endfor %}
                    </td>

                    <!-- Date -->
                    <td>{{ date.strftime('%B %d, %Y') }}</td>

                    <!-- Single Action Button -->
                    <td>
                        {% set ns = namespace(available_dep=None) %}
                        {% for dep in departures_on_date %}
                            {% if dep.spots_left > 0 and ns.available_dep is none %}
                                {% set ns.available_dep = dep %}
                            {% endif %}
                        {% endfor %}

                        {% if ns.available_dep %}
                            <a href="{{ url_for('tour') }}?departure_id={{ ns.available_dep.id }}&tour_title={{ ns.available_dep.tour.title | urlencode }}#booking-form-tour">
                                <button class="exp-book-btn">Book Now</button>
                            </a>
                        {% else %}
                            <button class="exp-book-btn" disabled>Fully Booked</button>
                        {% endif %}
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <!-- Pagination Controls -->
    <nav aria-label="Page navigation" style="margin-top: 1em;">
        <ul class="pagination justify-content-center">
            {% if current_page > 1 %}
            <li class="page-item">
                <a class="page-link" href="{{ url_for('home', page=current_page - 1) }}#exp-table" aria-label="Previous">
                    &laquo; Prev
                </a>
            </li>
            {% else %}
            <li class="page-item disabled">
                <span class="page-link">&laquo; Prev</span>
            </li>
            {% endif %}

            <li class="page-item disabled">
                <span class="page-link">Page {{ current_page }} of {{ total_pages }}</span>
            </li>

            {% if current_page < total_pages %}
            <li class="page-item">
                <a class="page-link" href="{{ url_for('home', page=current_page + 1) }}#exp-table" aria-label="Next">
                    Next &raquo;
                </a>
            </li>
            {% else %}
            <li class="page-item disabled">
                <span class="page-link">Next &raquo;</span>
            </li>
            {% endif %}
        </ul>
    </nav>
</section>




  <section class="bg-imgae">
    <img src="{{ url_for('static', filename='images/bg-home.jpg') }}" alt="Scenic view" class="div-home-img">

      <!-- Image Banner with Overlay Text -->
  <div class="div-home-text">
    <h2>ðŸŒ¿ Why Travel With Us</h2>
    <p>We are a locally registered and officially approved tour operator based in Socotra â€” not a reseller. When you book with us,
         youâ€™re booking directly with the people who live here. No third parties. <strong> No intermediaries. Just honest, transparent service.</strong></p>
<p>With over  <strong>a decade of hands-on experience</strong> organizing tours across the island, we know what travelers value most â€” and what makes Socotra
 unforgettable.</p>
<p>From your very first message to your safe arrival on the island, our dedicated team is by your side. Weâ€™re more than a travel service â€” weâ€™re 
your local hosts, ready to offer support, insight, and genuine hospitality every step of the way.</p>
<p> <strong>Your safety is always our top priority.</strong> Our experienced guides â€” all born and raised in Socotra â€” will introduce you to hidden landscapes, 
rich traditions, and the soul of the island. Their deep respect for this land ensures that you wonâ€™t just see Socotra â€” youâ€™ll feel at home in it.
</p>
  </div>
</div>

  </section>



<script>
document.addEventListener('DOMContentLoaded', function () {
  const container = document.querySelector('.exp-table-section');

  function interceptPagination() {
    document.querySelectorAll('.page-link').forEach(link => {
      link.addEventListener('click', function (e) {
        e.preventDefault();
        const url = this.getAttribute('href');

        fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const doc = parser.parseFromString(html, 'text/html');
            const newSection = doc.querySelector('.exp-table-section');

            if (newSection) {
              container.innerHTML = newSection.innerHTML;
              interceptPagination(); // Re-bind events after DOM update
            }
          });
      });
    });
  }

  interceptPagination();
});
</script>








{% endblock %}
